# ä½¿ç”¨ PyCaret å’Œ MLflow å®ç°ç®€å•çš„ MLOps

### ä½¿ç”¨ PyCaret + MLflow å®ç°ç®€å•çš„ MLOps

#### ä¸€ä»½é€‚åˆåˆå­¦è€…çš„ã€åˆ†æ­¥æ•™ç¨‹ï¼Œæ•™ä½ å¦‚ä½•ä½¿ç”¨ PyCaret åœ¨æœºå™¨å­¦ä¹ å®éªŒä¸­é›†æˆ MLOps

![Photo by Adi Goldstein on Unsplash](https://cdn-images-1.medium.com/max/7832/0\*WSGn8A3YB42ALgSg)

### PyCaret

PyCaret æ˜¯ä¸€ä¸ªå¼€æºçš„ã€ä½ä»£ç çš„æœºå™¨å­¦ä¹ åº“å’Œç«¯åˆ°ç«¯æ¨¡å‹ç®¡ç†å·¥å…·ï¼Œä½¿ç”¨ Python ç¼–å†™ï¼Œç”¨äºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ å·¥ä½œæµã€‚å®ƒä»¥æ˜“ç”¨æ€§ã€ç®€æ´æ€§å’Œå¿«é€Ÿé«˜æ•ˆåœ°æ„å»ºå’Œéƒ¨ç½²ç«¯åˆ°ç«¯æœºå™¨å­¦ä¹ åŸå‹çš„èƒ½åŠ›è€Œé—»åã€‚

PyCaret æ˜¯ä¸€ä¸ªæ›¿ä»£ä½ä»£ç åº“ï¼Œå¯ä»¥ç”¨å°‘é‡ä»£ç æ›¿ä»£æ•°ç™¾è¡Œä»£ç ã€‚è¿™ä½¿å¾—å®éªŒå‘¨æœŸæŒ‡æ•°çº§åŠ å¿«å’Œé«˜æ•ˆã€‚

![PyCaret - ä¸€ä¸ªå¼€æºçš„ã€ä½ä»£ç çš„ Python æœºå™¨å­¦ä¹ åº“](https://cdn-images-1.medium.com/max/2066/0\*IOqb01w3mfxSYsRi.png)

è¦äº†è§£æ›´å¤šå…³äº PyCaret çš„ä¿¡æ¯ï¼Œä½ å¯ä»¥æŸ¥çœ‹ä»–ä»¬çš„ [GitHub](https://www.github.com/pycaret/pycaret)ã€‚

### MLflow

MLflow æ˜¯ä¸€ä¸ªå¼€æºå¹³å°ï¼Œç”¨äºç®¡ç†æœºå™¨å­¦ä¹ çš„ç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…æ‹¬å®éªŒã€å¯é‡ç°æ€§ã€éƒ¨ç½²å’Œä¸­å¤®æ¨¡å‹æ³¨å†Œã€‚MLflow ç›®å‰æä¾›å››ä¸ªç»„ä»¶ï¼š

![MLflow æ˜¯ä¸€ä¸ªå¼€æºå¹³å°ï¼Œç”¨äºç®¡ç†æœºå™¨å­¦ä¹ çš„ç”Ÿå‘½å‘¨æœŸ](https://cdn-images-1.medium.com/max/2852/1\*EQ48xHBYlnqBKoas54URpQ.png)

è¦äº†è§£æ›´å¤šå…³äº MLflow çš„ä¿¡æ¯ï¼Œä½ å¯ä»¥æŸ¥çœ‹ [GitHub](https://github.com/mlflow/mlflow)ã€‚

### å®‰è£… PyCaret

å®‰è£… PyCaret éå¸¸ç®€å•ï¼Œåªéœ€å‡ åˆ†é’Ÿå³å¯å®Œæˆã€‚æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼Œä»¥é¿å…ä¸å…¶ä»–åº“å¯èƒ½å‘ç”Ÿçš„å†²çªã€‚

PyCaret çš„é»˜è®¤å®‰è£…æ˜¯ä¸€ä¸ªç²¾ç®€ç‰ˆæœ¬ï¼Œåªå®‰è£…ç¡¬ä¾èµ–é¡¹ [åœ¨è¿™é‡Œåˆ—å‡º](https://github.com/pycaret/pycaret/blob/master/requirements.txt)ã€‚

```
**# å®‰è£…ç²¾ç®€ç‰ˆæœ¬ï¼ˆé»˜è®¤ï¼‰
**pip install pycaret

**# å®‰è£…å®Œæ•´ç‰ˆæœ¬**
pip install pycaret[full]
```

å½“ä½ å®‰è£…å®Œæ•´ç‰ˆæœ¬çš„ pycaret æ—¶ï¼Œæ‰€æœ‰å¯é€‰ä¾èµ–é¡¹ [åœ¨è¿™é‡Œåˆ—å‡º](https://github.com/pycaret/pycaret/blob/master/requirements-optional.txt) ä¹Ÿä¼šè¢«å®‰è£…ã€‚MLflow æ˜¯ PyCaret çš„ä¾èµ–é¡¹ä¹‹ä¸€ï¼Œå› æ­¤ä¸éœ€è¦å•ç‹¬å®‰è£…ã€‚

### ğŸ‘‰ è®©æˆ‘ä»¬å¼€å§‹å§

åœ¨æˆ‘è®²è§£ MLOps ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ç®€è¦ä»‹ç»ä¸€ä¸‹æœºå™¨å­¦ä¹ ç”Ÿå‘½å‘¨æœŸçš„é«˜çº§æµç¨‹ï¼š

![æœºå™¨å­¦ä¹ ç”Ÿå‘½å‘¨æœŸ - å›¾ç‰‡ç”±ä½œè€…æä¾›ï¼ˆä»å·¦åˆ°å³é˜…è¯»ï¼‰](https://cdn-images-1.medium.com/max/2580/1\*qYCj8HXZ0CUD4DROjU9MAg.png)

* \*\*ä¸šåŠ¡é—®é¢˜ - \*\*è¿™æ˜¯æœºå™¨å­¦ä¹ å·¥ä½œæµçš„ç¬¬ä¸€æ­¥ã€‚æ ¹æ®ç”¨ä¾‹å’Œé—®é¢˜çš„å¤æ‚æ€§ï¼Œè¿™å¯èƒ½éœ€è¦å‡ å¤©åˆ°å‡ å‘¨çš„æ—¶é—´æ‰èƒ½å®Œæˆã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæ•°æ®ç§‘å­¦å®¶ä¸ä¸»é¢˜ä¸“å®¶ï¼ˆSMEï¼‰ä¼šé¢ï¼Œäº†è§£é—®é¢˜ï¼Œä¸å…³é”®åˆ©ç›Šç›¸å…³è€…è¿›è¡Œè®¿è°ˆï¼Œæ”¶é›†ä¿¡æ¯ï¼Œå¹¶è®¾å®šé¡¹ç›®çš„æ•´ä½“æœŸæœ›ã€‚
* \*\*æ•°æ®è·å–å’ŒETL - \*\*ä¸€æ—¦å®Œæˆé—®é¢˜ç†è§£ï¼Œå°±å¯ä»¥ä½¿ç”¨åœ¨è®¿è°ˆä¸­è·å¾—çš„ä¿¡æ¯ä»ä¼ä¸šæ•°æ®åº“ä¸­è·å–æ•°æ®ã€‚
* \*\*æ¢ç´¢æ€§æ•°æ®åˆ†æï¼ˆEDAï¼‰ - \*\*å»ºæ¨¡å°šæœªå¼€å§‹ã€‚EDA æ˜¯ä½ åˆ†æåŸå§‹æ•°æ®çš„åœ°æ–¹ã€‚ä½ çš„ç›®æ ‡æ˜¯æ¢ç´¢æ•°æ®å¹¶è¯„ä¼°æ•°æ®çš„è´¨é‡ã€ç¼ºå¤±å€¼ã€ç‰¹å¾åˆ†å¸ƒã€ç›¸å…³æ€§ç­‰ã€‚
* \*\*æ•°æ®å‡†å¤‡ - \*\*ç°åœ¨æ˜¯å‡†å¤‡æ•°æ®æ¨¡å‹è®­ç»ƒçš„æ—¶å€™äº†ã€‚è¿™åŒ…æ‹¬å°†æ•°æ®åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå¡«å……ç¼ºå¤±å€¼ï¼Œç‹¬çƒ­ç¼–ç ï¼Œç›®æ ‡ç¼–ç ï¼Œç‰¹å¾å·¥ç¨‹ï¼Œç‰¹å¾é€‰æ‹©ç­‰ã€‚
* \*\*æ¨¡å‹è®­ç»ƒå’Œé€‰æ‹© - \*\*è¿™æ˜¯æ¯ä¸ªäººéƒ½å…´å¥‹çš„ä¸€æ­¥ã€‚è¿™æ¶‰åŠè®­ç»ƒä¸€ç³»åˆ—æ¨¡å‹ï¼Œè°ƒæ•´è¶…å‚æ•°ï¼Œæ¨¡å‹é›†æˆï¼Œè¯„ä¼°æ€§èƒ½æŒ‡æ ‡ï¼Œæ¨¡å‹åˆ†æï¼ˆå¦‚AUCã€æ··æ·†çŸ©é˜µã€æ®‹å·®ç­‰ï¼‰ï¼Œæœ€åé€‰æ‹©ä¸€ä¸ªæœ€ä½³æ¨¡å‹ï¼Œç”¨äºåœ¨ä¸šåŠ¡ä¸­éƒ¨ç½²ä½¿ç”¨ã€‚
* \*\*éƒ¨ç½²å’Œç›‘æ§ - \*\*è¿™æ˜¯æœ€åä¸€æ­¥ï¼Œä¸»è¦æ¶‰åŠ MLOpsã€‚è¿™åŒ…æ‹¬å°†æœ€ç»ˆæ¨¡å‹æ‰“åŒ…ã€åˆ›å»º Docker é•œåƒã€ç¼–å†™è¯„åˆ†è„šæœ¬ï¼Œç„¶åä½¿å…¶ååŒå·¥ä½œï¼Œå¹¶æœ€ç»ˆå°†å…¶å‘å¸ƒä¸ºå¯ç”¨äºè·å–é€šè¿‡ç®¡é“ä¼ å…¥çš„æ–°æ•°æ®çš„é¢„æµ‹çš„ APIã€‚

ä»¥å‰çš„åšæ³•éå¸¸ç¹çã€å†—é•¿ï¼Œå¹¶ä¸”éœ€è¦å¾ˆå¤šæŠ€æœ¯çŸ¥è¯†ï¼Œæˆ‘å¯èƒ½æ— æ³•åœ¨ä¸€ä¸ªæ•™ç¨‹ä¸­æ¶µç›–æ‰€æœ‰å†…å®¹ã€‚ç„¶è€Œï¼Œåœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨ PyCaret æ¥æ¼”ç¤ºæ•°æ®ç§‘å­¦å®¶å¦‚ä½•ä»¥éå¸¸é«˜æ•ˆçš„æ–¹å¼å®Œæˆæ‰€æœ‰è¿™äº›å·¥ä½œã€‚åœ¨æˆ‘ä»¬è¿›å…¥å®é™…éƒ¨åˆ†ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å†å¤šè°ˆä¸€äº›å…³äº MLOps çš„å†…å®¹ã€‚

### ğŸ‘‰ **ä»€ä¹ˆæ˜¯ MLOpsï¼Ÿ**
MLOpsæ˜¯ä¸€é—¨å·¥ç¨‹å­¦ç§‘ï¼Œæ—¨åœ¨å°†ç”±æ•°æ®ç§‘å­¦å®¶é€šå¸¸æ‰§è¡Œçš„æœºå™¨å­¦ä¹ å¼€å‘ï¼ˆå®éªŒï¼ˆæ¨¡å‹è®­ç»ƒã€è¶…å‚æ•°è°ƒæ•´ã€æ¨¡å‹é›†æˆã€æ¨¡å‹é€‰æ‹©ç­‰ï¼‰ï¼‰ä¸MLå·¥ç¨‹å’Œè¿è¥ç›¸ç»“åˆï¼Œä»¥æ ‡å‡†åŒ–å’Œç®€åŒ–æœºå™¨å­¦ä¹ æ¨¡å‹åœ¨ç”Ÿäº§ä¸­çš„æŒç»­äº¤ä»˜ã€‚

å¦‚æœä½ æ˜¯ä¸€ä¸ªç»å¯¹çš„åˆå­¦è€…ï¼Œå¾ˆå¯èƒ½å¯¹æˆ‘æ‰€è¯´çš„ä¸€æ— æ‰€çŸ¥ã€‚åˆ«æ‹…å¿ƒã€‚è®©æˆ‘ç»™ä½ ä¸€ä¸ªç®€å•çš„ã€éæŠ€æœ¯æ€§çš„å®šä¹‰ï¼š

> *MLOpsæ˜¯ä¸€ç³»åˆ—æŠ€æœ¯å·¥ç¨‹å’Œè¿è¥ä»»åŠ¡ï¼Œä½¿ä½ çš„æœºå™¨å­¦ä¹ æ¨¡å‹èƒ½å¤Ÿè¢«ç»„ç»‡ä¸­çš„å…¶ä»–ç”¨æˆ·å’Œåº”ç”¨ç¨‹åºä½¿ç”¨ã€‚åŸºæœ¬ä¸Šï¼Œè¿™æ˜¯ä¸€ç§é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ çš„å·¥ä½œï¼Œå³*æœºå™¨å­¦ä¹ æ¨¡å‹_è¢«å‘å¸ƒåœ¨çº¿ï¼Œä»¥ä¾¿å…¶ä»–äººå¯ä»¥ä½¿ç”¨å®ƒä»¬å¹¶æ»¡è¶³ä¸€äº›ä¸šåŠ¡ç›®æ ‡ã€‚_

è¿™æ˜¯MLOpsçš„ä¸€ä¸ªéå¸¸ç®€åŒ–çš„å®šä¹‰ã€‚å®é™…ä¸Šï¼Œå®ƒæ¶‰åŠçš„å·¥ä½œå’Œå¥½å¤„æ¯”è¿™æ›´å¤šï¼Œä½†å¦‚æœä½ å¯¹è¿™ä¸€åˆ‡éƒ½æ˜¯æ–°æ‰‹ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¼€å§‹ã€‚

ç°åœ¨è®©æˆ‘ä»¬æŒ‰ç…§ä¸Šé¢å›¾è¡¨æ‰€ç¤ºçš„ç›¸åŒå·¥ä½œæµç¨‹æ¥è¿›è¡Œä¸€ä¸ªå®é™…æ¼”ç¤ºï¼Œç¡®ä¿ä½ å·²ç»å®‰è£…äº†pycaretã€‚

### ğŸ‘‰ ä¸šåŠ¡é—®é¢˜

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨è¾¾é¡¿å•†å­¦é™¢å‘è¡¨åœ¨[å“ˆä½›å•†ä¸šè¯„è®º](https://hbsp.harvard.edu/product/UV0869-PDF-ENG)ä¸Šçš„ä¸€ä¸ªéå¸¸æµè¡Œçš„æ¡ˆä¾‹ç ”ç©¶ã€‚è¯¥æ¡ˆä¾‹æ¶‰åŠåˆ°ä¸¤ä¸ªå°†æ¥è¦ç»“å©šçš„äººçš„æ•…äº‹ã€‚ä¸€ä¸ªåå«*æ ¼é›·æ ¼*çš„ç”·å£«æƒ³è¦ä¹°ä¸€æšæˆ’æŒ‡å‘ä¸€ä¸ªåå«_èæ‹‰_çš„å¥³å£«æ±‚å©šã€‚é—®é¢˜æ˜¯è¦æ‰¾åˆ°èæ‹‰ä¼šå–œæ¬¢çš„æˆ’æŒ‡ï¼Œä½†åœ¨ä»–çš„å¥½å‹å»ºè®®åï¼Œæ ¼é›·æ ¼å†³å®šè´­ä¹°ä¸€é¢—é’»çŸ³ï¼Œè®©èæ‹‰è‡ªå·±é€‰æ‹©ã€‚ç„¶åï¼Œæ ¼é›·æ ¼æ”¶é›†äº†6000é¢—é’»çŸ³çš„æ•°æ®ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„ä»·æ ¼å’Œå±æ€§ï¼Œå¦‚åˆ‡å‰²ã€é¢œè‰²ã€å½¢çŠ¶ç­‰ã€‚

### ğŸ‘‰ æ•°æ®

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨è¾¾é¡¿å•†å­¦é™¢å‘è¡¨åœ¨[å“ˆä½›å•†ä¸šè¯„è®º](https://hbsp.harvard.edu/product/UV0869-PDF-ENG)ä¸Šçš„ä¸€ä¸ªéå¸¸æµè¡Œçš„æ¡ˆä¾‹ç ”ç©¶ä¸­çš„æ•°æ®é›†ã€‚æœ¬æ•™ç¨‹çš„ç›®æ ‡æ˜¯æ ¹æ®å…¶å±æ€§ï¼ˆå¦‚å…‹æ‹‰é‡é‡ã€åˆ‡å‰²ã€é¢œè‰²ç­‰ï¼‰æ¥é¢„æµ‹é’»çŸ³çš„ä»·æ ¼ã€‚ä½ å¯ä»¥ä»[PyCaretçš„æ•°æ®é›†](https://github.com/pycaret/pycaret/tree/master/datasets)ä¸­ä¸‹è½½æ•°æ®é›†ã€‚

```
**# ä»pycaretåŠ è½½æ•°æ®é›†
**from pycaret.datasets import get_data
data = get_data('diamond')
```

![æ•°æ®æ ·æœ¬è¡Œ](https://cdn-images-1.medium.com/max/2000/0\*rDRvbnmVe7vDGPVM.png)

### ğŸ‘‰ æ¢ç´¢æ€§æ•°æ®åˆ†æ

è®©æˆ‘ä»¬è¿›è¡Œä¸€äº›å¿«é€Ÿçš„å¯è§†åŒ–ï¼Œè¯„ä¼°ç‹¬ç«‹ç‰¹å¾ï¼ˆé‡é‡ã€åˆ‡å‰²ã€é¢œè‰²ã€æ¸…æ™°åº¦ç­‰ï¼‰ä¸ç›®æ ‡å˜é‡å³ä»·æ ¼ä¹‹é—´çš„å…³ç³»ã€‚

```
**# ç»˜åˆ¶å…‹æ‹‰é‡é‡å’Œä»·æ ¼çš„æ•£ç‚¹å›¾**
import plotly.express as px
fig = px.scatter(x=data['Carat Weight'], y=data['Price'], 
                 facet_col = data['Cut'], opacity = 0.25, template = 'plotly_dark', trendline='ols',
                 trendline_color_override = 'red', title = 'èæ‹‰å¾—åˆ°ä¸€é¢—é’»çŸ³ - ä¸€ä¸ªæ¡ˆä¾‹ç ”ç©¶')
fig.show()
```

![èæ‹‰å¾—åˆ°ä¸€é¢—é’»çŸ³æ¡ˆä¾‹ç ”ç©¶](https://cdn-images-1.medium.com/max/2328/0\*Lo6mo1OUPjb-Cenm.png)

è®©æˆ‘ä»¬æ£€æŸ¥ç›®æ ‡å˜é‡çš„åˆ†å¸ƒã€‚

```
**# ç»˜åˆ¶ç›´æ–¹å›¾**
fig = px.histogram(data, x=["Price"], template = 'plotly_dark', title = 'ä»·æ ¼ç›´æ–¹å›¾')
fig.show()
```

![](https://cdn-images-1.medium.com/max/2316/0\*VjW1-hOpd7hVBtIj.png)

æ³¨æ„åˆ°ä»·æ ¼çš„åˆ†å¸ƒæ˜¯å³åçš„ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿæ£€æŸ¥å¯¹æ•°è½¬æ¢æ˜¯å¦å¯ä»¥ä½¿ä»·æ ¼è¿‘ä¼¼æ­£æ€ï¼Œä»è€Œä¸ºå‡è®¾æ­£æ€æ€§çš„ç®—æ³•æä¾›ä¸€äº›æœºä¼šã€‚

```
import numpy as np

**# åˆ›å»ºæ•°æ®çš„å‰¯æœ¬**
data_copy = data.copy()

**# åˆ›å»ºä¸€ä¸ªæ–°ç‰¹å¾Log_Price**
data_copy['Log_Price'] = np.log(data['Price'])

**# ç»˜åˆ¶ç›´æ–¹å›¾**
fig = px.histogram(data_copy, x=["Log_Price"], title = 'å¯¹æ•°ä»·æ ¼ç›´æ–¹å›¾', template = 'plotly_dark')
fig.show()
```

![](https://cdn-images-1.medium.com/max/2322/0\*KfvEU2c6f8LdjUPS.png)

è¿™è¯å®äº†æˆ‘ä»¬çš„å‡è®¾ã€‚è¿™ç§è½¬æ¢å°†å¸®åŠ©æˆ‘ä»¬æ‘†è„±åæ–œï¼Œå¹¶ä½¿ç›®æ ‡å˜é‡è¿‘ä¼¼æ­£æ€ã€‚åŸºäºæ­¤ï¼Œæˆ‘ä»¬å°†åœ¨è®­ç»ƒæ¨¡å‹ä¹‹å‰å¯¹ä»·æ ¼å˜é‡è¿›è¡Œè½¬æ¢ã€‚

### ğŸ‘‰ æ•°æ®å‡†å¤‡

åœ¨PyCaretçš„æ‰€æœ‰æ¨¡å—ä¸­ï¼Œè®¾ç½®æ˜¯ä½¿ç”¨PyCaretè¿›è¡Œä»»ä½•æœºå™¨å­¦ä¹ å®éªŒçš„ç¬¬ä¸€ä¸ªä¸”å”¯ä¸€å¼ºåˆ¶æ€§æ­¥éª¤ã€‚æ­¤å‡½æ•°è´Ÿè´£æ‰€æœ‰è®­ç»ƒæ¨¡å‹ä¹‹å‰æ‰€éœ€çš„æ•°æ®å‡†å¤‡å·¥ä½œã€‚é™¤äº†æ‰§è¡Œä¸€äº›åŸºæœ¬çš„é»˜è®¤å¤„ç†ä»»åŠ¡å¤–ï¼ŒPyCaretè¿˜æä¾›äº†å„ç§é¢„å¤„ç†åŠŸèƒ½ã€‚è¦äº†è§£æœ‰å…³PyCaretä¸­æ‰€æœ‰é¢„å¤„ç†åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ï¼Œä½ å¯ä»¥æŸ¥çœ‹è¿™ä¸ª[é“¾æ¥](https://pycaret.org/preprocessing/)ã€‚

```
**# åˆå§‹åŒ–è®¾ç½®**
from pycaret.regression import *
s = setup(data, target = 'Price', transform_target = True, log_experiment = True, experiment_name = 'diamond')
```

![pycaret.regressionæ¨¡å—ä¸­çš„è®¾ç½®å‡½æ•°](https://cdn-images-1.medium.com/max/2736/0\*dCiKXVXfpXyYQiYd.png)
å½“æ‚¨åœ¨ PyCaret ä¸­åˆå§‹åŒ–è®¾ç½®å‡½æ•°æ—¶ï¼Œå®ƒä¼šå¯¹æ•°æ®é›†è¿›è¡Œåˆ†æï¼Œå¹¶æ¨æ–­æ‰€æœ‰è¾“å…¥ç‰¹å¾çš„æ•°æ®ç±»å‹ã€‚å¦‚æœæ‰€æœ‰æ•°æ®ç±»å‹éƒ½è¢«æ­£ç¡®æ¨æ–­ï¼Œæ‚¨å¯ä»¥æŒ‰ Enter é”®ç»§ç»­ã€‚

è¯·æ³¨æ„ï¼š

* æˆ‘å·²ç»ä¼ é€’äº† log\_experiment = True å’Œ experiment\_name = 'diamond' ï¼Œè¿™å°†å‘Šè¯‰ PyCaret åœ¨æ‚¨é€šè¿‡å»ºæ¨¡é˜¶æ®µæ—¶è‡ªåŠ¨è®°å½•æ‰€æœ‰æŒ‡æ ‡ã€è¶…å‚æ•°å’Œæ¨¡å‹å·¥ä»¶çš„èƒŒåä¿¡æ¯ã€‚è¿™å¾—ç›Šäºä¸ [MLflow](https://www.mlflow.org) çš„é›†æˆã€‚
* å¦å¤–ï¼Œæˆ‘åœ¨è®¾ç½®ä¸­ä½¿ç”¨äº† transform\_target = Trueã€‚PyCaret å°†åœ¨å¹•åä½¿ç”¨ Box-Cox è½¬æ¢æ¥è½¬æ¢ä»·æ ¼å˜é‡ã€‚å®ƒä¼šä»¥ä¸å¯¹æ•°è½¬æ¢ç›¸ä¼¼çš„æ–¹å¼å½±å“æ•°æ®çš„åˆ†å¸ƒï¼ˆ_åœ¨æŠ€æœ¯ä¸Šæœ‰æ‰€ä¸åŒ_ï¼‰ã€‚å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šå…³äº Box-Cox è½¬æ¢çš„ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ª [é“¾æ¥](https://onlinestatbook.com/2/transformations/box-cox.html)ã€‚

![è®¾ç½®è¾“å‡º â€” ä¸ºæ˜¾ç¤ºè€Œæˆªæ–­](https://cdn-images-1.medium.com/max/2000/0\*b5w1YKkwK2G9n\_YA.png)

### ğŸ‘‰ æ¨¡å‹è®­ç»ƒä¸é€‰æ‹©

ç°åœ¨æ•°æ®å·²ç»å‡†å¤‡å¥½è¿›è¡Œå»ºæ¨¡ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ compare\_models å‡½æ•°å¼€å§‹è®­ç»ƒè¿‡ç¨‹ã€‚å®ƒå°†è®­ç»ƒæ¨¡å‹åº“ä¸­çš„æ‰€æœ‰å¯ç”¨ç®—æ³•ï¼Œå¹¶ä½¿ç”¨ k æŠ˜äº¤å‰éªŒè¯è¯„ä¼°å¤šä¸ªæ€§èƒ½æŒ‡æ ‡ã€‚

```
**# æ¯”è¾ƒæ‰€æœ‰æ¨¡å‹**
best = compare_models()
```

![compare\_models çš„è¾“å‡º](https://cdn-images-1.medium.com/max/2000/0\*FZAGMj-lU-C\_kxRl.png)

```
**# æ£€æŸ¥å·²è®­ç»ƒæ¨¡å‹çš„æ®‹å·®**
plot_model(best, plot = 'residuals_interactive')
```

![æœ€ä½³æ¨¡å‹çš„æ®‹å·®å’Œ QQ å›¾](https://cdn-images-1.medium.com/max/2590/0\*yOzbuZjSXY4s2v4Z.png)

```
**# æ£€æŸ¥ç‰¹å¾é‡è¦æ€§**
plot_model(best, plot = 'feature')
```

![](https://cdn-images-1.medium.com/max/2068/0\*m8k8VaglnYOkNx5x.png)

#### å®Œæˆå¹¶ä¿å­˜ç®¡é“

ç°åœ¨è®©æˆ‘ä»¬æœ€ç»ˆç¡®å®šæœ€ä½³æ¨¡å‹ï¼Œå³åœ¨æ•´ä¸ªæ•°æ®é›†ï¼ˆåŒ…æ‹¬æµ‹è¯•é›†ï¼‰ä¸Šè®­ç»ƒæœ€ä½³æ¨¡å‹ï¼Œç„¶åå°†ç®¡é“ä¿å­˜ä¸º pickle æ–‡ä»¶ã€‚

```
**# å®Œæˆæ¨¡å‹**
final_best = finalize_model(best)

**# å°†æ¨¡å‹ä¿å­˜åˆ°ç£ç›˜
**save_model(final_best, 'diamond-pipeline')
```

save\_model å‡½æ•°å°†æ•´ä¸ªç®¡é“ï¼ˆåŒ…æ‹¬æ¨¡å‹ï¼‰ä¿å­˜ä¸º pickle æ–‡ä»¶åœ¨æ‚¨çš„æœ¬åœ°ç£ç›˜ä¸Šã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå°†åœ¨ä¸æ‚¨çš„ Notebook æˆ–è„šæœ¬ç›¸åŒçš„æ–‡ä»¶å¤¹ä¸­ä¿å­˜æ–‡ä»¶ï¼Œä½†å¦‚æœæ‚¨æ„¿æ„ï¼Œä¹Ÿå¯ä»¥ä¼ é€’å®Œæ•´è·¯å¾„ï¼š

```
save_model(final_best, 'c:/users/moez/models/diamond-pipeline'
```

### ğŸ‘‰ éƒ¨ç½²

è¯·è®°ä½ï¼Œåœ¨è®¾ç½®å‡½æ•°ä¸­æˆ‘ä»¬ä¼ é€’äº† log\_experiment = True ä»¥åŠ experiment\_name = 'diamond'ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ PyCaret åœ¨å¹•åå€ŸåŠ© MLflow åšäº†ä»€ä¹ˆç¥å¥‡çš„äº‹æƒ…ã€‚è¦æŸ¥çœ‹ç¥å¥‡ä¹‹å¤„ï¼Œè®©æˆ‘ä»¬å¯åŠ¨ MLflow æœåŠ¡å™¨ï¼š

```
**# åœ¨ç¬”è®°æœ¬å†…ï¼ˆæ³¨æ„ï¼ç¬¦å·åœ¨å‰é¢ï¼‰
**!mlflow ui

**# åœ¨ç›¸åŒæ–‡ä»¶å¤¹çš„å‘½ä»¤è¡Œä¸­
**mlflow ui
```

ç°åœ¨æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥â€œlocalhost:5000â€ã€‚å®ƒå°†æ‰“å¼€ä¸€ä¸ªç±»ä¼¼è¿™æ ·çš„ç”¨æˆ·ç•Œé¢ï¼š

![https://localhost:5000](https://cdn-images-1.medium.com/max/3836/1\*yZ4zThh0tnY0uW8SsLCpdw.png)

ä¸Šè¡¨ä¸­çš„æ¯ä¸ªæ¡ç›®ä»£è¡¨ä¸€ä¸ªè®­ç»ƒè¿è¡Œï¼Œäº§ç”Ÿäº†ä¸€ä¸ªç»è¿‡è®­ç»ƒçš„ç®¡é“å’Œä¸€å †å…ƒæ•°æ®ï¼Œå¦‚è¿è¡Œçš„æ—¥æœŸæ—¶é—´ã€æ€§èƒ½æŒ‡æ ‡ã€æ¨¡å‹è¶…å‚æ•°ã€æ ‡ç­¾ç­‰ã€‚è®©æˆ‘ä»¬ç‚¹å‡»å…¶ä¸­ä¸€ä¸ªæ¨¡å‹ï¼š

![ç¬¬ä¸€éƒ¨åˆ† â€” CatBoost å›å½’å™¨](https://cdn-images-1.medium.com/max/3776/1\*TQEApDxCxDIoN6GWwvbBZw.png)

![ç¬¬äºŒéƒ¨åˆ† â€” CatBoost å›å½’å™¨ï¼ˆç»­ï¼‰](https://cdn-images-1.medium.com/max/2438/1\*RVC18B9Zk8rJkLp28jHkjA.png)

![ç¬¬äºŒéƒ¨åˆ† â€” CatBoost å›å½’å™¨ï¼ˆç»­ï¼‰](https://cdn-images-1.medium.com/max/3392/1\*1rsOUsPzyY3O0Djao2KlzQ.png)

è¯·æ³¨æ„ï¼Œæ‚¨æœ‰ä¸€ä¸ª logged\_model çš„åœ°å€è·¯å¾„ã€‚è¿™æ˜¯ç»è¿‡ Catboost å›å½’å™¨è®­ç»ƒçš„ç®¡é“ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ load\_model å‡½æ•°è¯»å–æ­¤ç®¡é“ã€‚

```
**# åŠ è½½æ¨¡å‹**
from pycaret.regression import load_model
pipeline = load_model('C:/Users/moezs/mlruns/1/b8c10d259b294b28a3e233a9d2c209c0/artifacts/model/model')

**# æ‰“å°ç®¡é“
**print(pipeline)
```

![print(pipeline) çš„è¾“å‡º](https://cdn-images-1.medium.com/max/2916/1\*E0dUApG1JQnddUfVHmCYvg.png)

ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨æ­¤ç®¡é“åœ¨æ–°æ•°æ®ä¸Šç”Ÿæˆé¢„æµ‹

```
**# åˆ›å»ºæ•°æ®å‰¯æœ¬å¹¶åˆ é™¤ä»·æ ¼
**data2 = data.copy()
data2.drop('Price', axis=1, inplace=True)

**# ç”Ÿæˆé¢„æµ‹
**from pycaret.regression import predict_model
predictions = predict_model(pipeline, data=data2)
predictions.head()
```

![ä»ç®¡é“ç”Ÿæˆçš„é¢„æµ‹](https://cdn-images-1.medium.com/max/2000/1\*IVtFV6oRqcsgyNQTHbb3QA.png)

å“‡ï¼æˆ‘ä»¬ç°åœ¨ä»è®­ç»ƒè¿‡çš„ç®¡é“ä¸­å¾—åˆ°äº†æ¨æ–­ã€‚æ­å–œï¼Œå¦‚æœè¿™æ˜¯æ‚¨çš„ç¬¬ä¸€ä¸ªã€‚è¯·æ³¨æ„ï¼Œæ‰€æœ‰è½¬æ¢ï¼Œå¦‚ç›®æ ‡è½¬æ¢ã€ç‹¬çƒ­ç¼–ç ã€ç¼ºå¤±å€¼å¡«å……ç­‰éƒ½åœ¨å¹•åè‡ªåŠ¨å‘ç”Ÿã€‚æ‚¨å¾—åˆ°äº†ä¸€ä¸ªå¸¦æœ‰å®é™…è§„æ¨¡é¢„æµ‹çš„æ•°æ®æ¡†ï¼Œè¿™æ‰æ˜¯æ‚¨å…³å¿ƒçš„ã€‚

### æ•¬è¯·æœŸå¾…ï¼
ä»Šå¤©æˆ‘å±•ç¤ºçš„æ˜¯ä½¿ç”¨ MLflow åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ PyCaret è®­ç»ƒçš„ Pipeline çš„ä¸€ç§æ–¹æ³•ã€‚åœ¨ä¸‹ä¸€ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘è®¡åˆ’å±•ç¤ºå¦‚ä½•ä½¿ç”¨ MLflow çš„åŸç”Ÿ serving åŠŸèƒ½æ¥æ³¨å†Œæ¨¡å‹ã€å¯¹å…¶è¿›è¡Œç‰ˆæœ¬ç®¡ç†å¹¶ä½œä¸º API æä¾›æœåŠ¡ã€‚

ä½¿ç”¨è¿™ä¸ªè½»é‡çº§çš„ Python å·¥ä½œæµè‡ªåŠ¨åŒ–åº“ï¼Œæ‚¨å¯ä»¥å®ç°æ— é™çš„å¯èƒ½ã€‚å¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªå·¥å…·æœ‰ç”¨ï¼Œè¯·ä¸è¦å¿˜è®°åœ¨æˆ‘ä»¬çš„ GitHub ä»“åº“ä¸Šç»™æˆ‘ä»¬ä¸€ä¸ª â­ï¸ã€‚

è¦äº†è§£æ›´å¤šå…³äº PyCaret çš„ä¿¡æ¯ï¼Œè¯·å…³æ³¨æˆ‘ä»¬çš„ [LinkedIn](https://www.linkedin.com/company/pycaret/) å’Œ [Youtube](https://www.youtube.com/channel/UCxA1YTYJ9BEeo50lxyI_B3g)ã€‚

åŠ å…¥æˆ‘ä»¬çš„ Slack é¢‘é“ã€‚é‚€è¯·é“¾æ¥åœ¨[è¿™é‡Œ](https://join.slack.com/t/pycaret/shared_invite/zt-p7aaexnl-EqdTfZ9U~mF0CwNcltffHg)ã€‚

### æ‚¨å¯èƒ½è¿˜å¯¹ä»¥ä¸‹å†…å®¹æ„Ÿå…´è¶£ï¼š

- [ä½¿ç”¨ PyCaret 2.0 åœ¨ Power BI ä¸­æ„å»ºè‡ªå·±çš„ AutoML](https://towardsdatascience.com/build-your-own-automl-in-power-bi-using-pycaret-8291b64181d)
- [ä½¿ç”¨ Docker åœ¨ Azure ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹  Pipeline](https://towardsdatascience.com/deploy-machine-learning-pipeline-on-cloud-using-docker-container-bec64458dc01)
- [åœ¨ Google Kubernetes Engine ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹  Pipeline](https://towardsdatascience.com/deploy-machine-learning-model-on-google-kubernetes-engine-94daac85108b)
- [åœ¨ AWS Fargate ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹  Pipeline](https://towardsdatascience.com/deploy-machine-learning-pipeline-on-aws-fargate-eb6e1c50507)
- [æ„å»ºå’Œéƒ¨ç½²æ‚¨çš„ç¬¬ä¸€ä¸ªæœºå™¨å­¦ä¹  Web åº”ç”¨](https://towardsdatascience.com/build-and-deploy-your-first-machine-learning-web-app-e020db344a99)
- [ä½¿ç”¨ AWS Fargate æ— æœåŠ¡å™¨éƒ¨ç½² PyCaret å’Œ Streamlit åº”ç”¨](https://towardsdatascience.com/deploy-pycaret-and-streamlit-app-using-aws-fargate-serverless-infrastructure-8b7d7c0584c2)
- [ä½¿ç”¨ PyCaret å’Œ Streamlit æ„å»ºå’Œéƒ¨ç½²æœºå™¨å­¦ä¹  Web åº”ç”¨](https://towardsdatascience.com/build-and-deploy-machine-learning-web-app-using-pycaret-and-streamlit-28883a569104)
- [åœ¨ GKE ä¸Šéƒ¨ç½²ä½¿ç”¨ Streamlit å’Œ PyCaret æ„å»ºçš„æœºå™¨å­¦ä¹ åº”ç”¨](https://towardsdatascience.com/deploy-machine-learning-app-built-using-streamlit-and-pycaret-on-google-kubernetes-engine-fd7e393d99cb)

### é‡è¦é“¾æ¥

- [æ–‡æ¡£](https://pycaret.readthedocs.io/en/latest/installation.html)
- [åšå®¢](https://medium.com/@moez_62905)
- [GitHub](http://www.github.com/pycaret/pycaret)
- [StackOverflow](https://stackoverflow.com/questions/tagged/pycaret)
- [å®‰è£… PyCaret](https://pycaret.readthedocs.io/en/latest/installation.html)
- [Notebook æ•™ç¨‹](https://pycaret.readthedocs.io/en/latest/tutorials.html)
- [ä¸º PyCaret åšè´¡çŒ®](https://pycaret.readthedocs.io/en/latest/contribute.html)

### æƒ³äº†è§£ç‰¹å®šæ¨¡å—çš„ä¿¡æ¯å—ï¼Ÿ

ç‚¹å‡»ä¸‹é¢çš„é“¾æ¥æŸ¥çœ‹æ–‡æ¡£å’Œå·¥ä½œç¤ºä¾‹ã€‚

- [åˆ†ç±»](https://pycaret.readthedocs.io/en/latest/api/classification.html)
- [å›å½’](https://pycaret.readthedocs.io/en/latest/api/regression.html)
- [èšç±»](https://pycaret.readthedocs.io/en/latest/api/clustering.html)
- [å¼‚å¸¸æ£€æµ‹](https://pycaret.readthedocs.io/en/latest/api/anomaly.html)
- [è‡ªç„¶è¯­è¨€å¤„ç†](https://pycaret.readthedocs.io/en/latest/api/nlp.html)
- [å…³è”è§„åˆ™æŒ–æ˜](https://pycaret.readthedocs.io/en/latest/api/arules.html)